<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Collections - Aurelia Jewelry</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="product.css">
</head>
<body>
    <!-- Enhanced Offer Bar -->
    <div class="offer-bar">
        <span>DIWALI SALE | BUY 1 GET 1 FREE | Use Code:</span>
        <span class="offer-code">DIWALI</span>
    </div>

    <!-- Enhanced Header -->
    <header class="header">
        <div class="header-container">
            <a href="homepage.html" class="logo">Aurelia</a>
            
            <nav class="nav-links">
                <a href="collections.html" class="nav-link">Latest Collections</a>
                <div class="dropdown">
                    <button class="dropbtn nav-link">
                        Categories <span class="dropdown-arrow">▼</span>
                    </button>
                    <div class="dropdown-content">
                        <a href="rings.html">Rings</a>
                        <a href="bracelets.html">Bracelets</a>
                        <a href="earrings.html">Earrings</a>
                        <a href="necklaces.html">Necklaces</a>
                    </div>
                </div>
                <a href="customerstories.html" class="nav-link" target="_blank">Customer Stories</a>
                <a href="about.html" class="nav-link">About Us</a>
            </nav>

            <div class="search-box">
                <input type="text" class="search-input" placeholder="Search jewelry...">
            </div>

            <div class="nav-actions">
                <a href="wishlist.html" class="nav-icon wishlist-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                </a>
                <a href="account.html" class="nav-icon account-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </a>
                <a href="cart.html" class="nav-icon cart-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="9" cy="21" r="1"></circle>
                        <circle cx="20" cy="21" r="1"></circle>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                    </svg>
                </a>
            </div>
        </div>
    </header>

    <section class="sale-banner">
        <img src="https://nakshatrajewels.in/cdn/shop/files/s8.png?v=1720001073&width=3840" alt="Sale Banner" class="sale-banner-img">
        <div class="sale-banner-content">
            <h1 class="hero-title">Our Collections</h1>
            <p class="hero-subtitle">Discover timeless elegance in every piece</p>
        </div>
    </section>

    <!-- Filter Section -->
    <div class="filter-section">
        <button class="filter-btn active" data-filter="all">All Products</button>
        <button class="filter-btn" data-filter="Earrings">Earrings</button>
        <button class="filter-btn" data-filter="Rings">Rings</button>
        <button class="filter-btn" data-filter="Necklaces">Necklaces</button>
        <button class="filter-btn" data-filter="Bracelets">Bracelets</button>
    </div>

    <!-- New Arrivals Section -->
    <section class="product-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">New Arrivals</h2>
            </div>
            <div id="newArrivalsGrid" class="products-grid">
                <div class="loading">Loading products...</div>
            </div>
        </div>
    </section>

    <!-- Most Gifted Section -->
    <section class="product-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Most Gifted</h2>
            </div>
            <div id="mostGiftedGrid" class="products-grid">
                <div class="loading">Loading products...</div>
            </div>
        </div>
    </section>

    <!-- Recently Viewed Section -->
    <section class="product-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Recently Viewed</h2>
            </div>
            <div id="recentlyViewedGrid" class="products-grid">
                <div class="loading">Loading products...</div>
            </div>
        </div>
    </section>

    <div class="shop-more-section">
        <a href="#" class="shop-more-btn">Shop More</a>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="newsletter">
                    <h3>Stay Connected</h3>
                    <p style="color: #CCCCCC; margin-bottom: 20px;">Subscribe to our newsletter for exclusive offers and new arrivals</p>
                    <form class="newsletter-form" id="newsletterForm">
                        <input type="email" class="newsletter-input" id="newsletterEmail" placeholder="Enter your email" required>
                        <button type="submit" class="newsletter-button">Subscribe</button>
                    </form>
                    <p id="newsletterMessage" style="color: #D4AF37; margin-top: 10px; font-size: 0.9rem;"></p>
                </div>
                
                <div class="footer-links">
                    <h4>About</h4>
                    <ul>
                        <li><a href="about_us.html">Our Story</a></li>
                        <li><a href="about_us.html">Careers</a></li>
                        <li><a href="about_us.html">Press</a></li>
                    </ul>
                </div>
                
                <div class="footer-links">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="support.html">Shipping</a></li>
                        <li><a href="support.html">Returns</a></li>
                        <li><a href="support.html">Size Guide</a></li>
                        <li><a href="support.html">Contact</a></li>
                    </ul>
                </div>
                
                <div class="footer-links">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="terms.html">Privacy Policy</a></li>
                        <li><a href="terms.html">Terms of Service</a></li>
                        <li><a href="terms.html">Cookies</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p style="color: #CCCCCC; font-size: 0.9rem;">© 2024 Aurelia Jewelry. All rights reserved.</p>
                <div class="social-icons">
                    <a href="https://instagram.com" class="social-icon" target="_blank">
                        <i class="fab fa-instagram" style="color: #D4AF37; font-size: 16px;"></i>
                    </a>
                    <a href="https://facebook.com" class="social-icon" target="_blank">
                        <i class="fab fa-facebook-f" style="color: #D4AF37; font-size: 16px;"></i>
                    </a>
                    <a href="https://pinterest.com" class="social-icon" target="_blank">
                        <i class="fab fa-pinterest-p" style="color: #D4AF37; font-size: 16px;"></i>
                    </a>
                    <a href="https://twitter.com" class="social-icon" target="_blank">
                        <i class="fab fa-twitter" style="color: #D4AF37; font-size: 16px;"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // ========== OOP CLASSES ==========

        // Product Class - Represents a single product
        class Product {
            constructor(data) {
                this.id = data.id;
                this.name = data.name;
                this.price = data.price;
                this.image = data.image;
                this.category = data.category;
                this.description = data.description || '';
            }

            getFormattedPrice() {
                return `₹${this.price.toLocaleString('en-IN')}`;
            }

            renderHTML() {
                return `
                    <div class="product-card" data-id="${this.id}" data-category="${this.category}">
                        <div class="product-image" style="background-image: url('${this.image}');"></div>
                        <div class="product-info">
                            <div class="product-name">${this.name}</div>
                            <div class="product-actions">
                                <div class="product-price">${this.getFormattedPrice()}</div>
                                <div class="action-icons">
                                    <div class="action-icon wishlist-icon" data-id="${this.id}" title="Add to Wishlist">♡</div>
                                    <div class="action-icon compare-icon" data-id="${this.id}" title="Compare">⚖</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // ProductCollection Class - Manages a collection of products
        class ProductCollection {
            constructor(name) {
                this.name = name;
                this.products = [];
            }

            addProducts(productsData) {
                this.products = productsData.map(data => new Product(data));
            }

            render(containerId) {
                const container = document.getElementById(containerId);
                if (!container) return;

                if (this.products.length === 0) {
                    container.innerHTML = '<div class="error-message">No products available</div>';
                    return;
                }

                container.innerHTML = this.products.map(product => product.renderHTML()).join('');
                this.attachEventListeners(container);
            }

            attachEventListeners(container) {
                // Wishlist functionality
                container.querySelectorAll('.wishlist-icon').forEach(icon => {
                    icon.addEventListener('click', (e) => {
                        e.stopPropagation();
                        icon.classList.toggle('active');
                        const productId = icon.getAttribute('data-id');
                        const product = this.products.find(p => p.id == productId);
                        if (product) {
                            wishlistManager.toggle(product);
                        }
                    });
                });

                // Compare functionality
                container.querySelectorAll('.compare-icon').forEach(icon => {
                    icon.addEventListener('click', (e) => {
                        e.stopPropagation();
                        icon.classList.toggle('active');
                        const productId = icon.getAttribute('data-id');
                        const product = this.products.find(p => p.id == productId);
                        if (product) {
                            compareManager.toggle(product);
                        }
                    });
                });
            }

            filterByCategory(category) {
                if (category === 'all') return this.products;
                return this.products.filter(p => p.category === category);
            }

            search(query) {
                const lowerQuery = query.toLowerCase();
                return this.products.filter(p => 
                    p.name.toLowerCase().includes(lowerQuery) ||
                    p.category.toLowerCase().includes(lowerQuery)
                );
            }
        }

        // WishlistManager Class - Manages wishlist functionality
        class WishlistManager {
            constructor() {
                this.items = [];
            }

            toggle(product) {
                const index = this.items.findIndex(item => item.id === product.id);
                if (index > -1) {
                    this.items.splice(index, 1);
                    this.showNotification(`${product.name} removed from wishlist`);
                } else {
                    this.items.push(product);
                    this.showNotification(`${product.name} added to wishlist`);
                }
                console.log('Wishlist:', this.items);
            }

            showNotification(message) {
                const notification = document.createElement('div');
                notification.textContent = message;
                notification.style.cssText = 'position: fixed; top: 80px; right: 20px; background: #D4AF37; color: #000; padding: 15px 25px; border-radius: 10px; font-weight: 600; z-index: 10001; animation: slideIn 0.3s ease;';
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }, 2000);
            }
        }

        // CompareManager Class - Manages product comparison
        class CompareManager {
            constructor() {
                this.items = [];
                this.maxItems = 4;
            }

            toggle(product) {
                const index = this.items.findIndex(item => item.id === product.id);
                if (index > -1) {
                    this.items.splice(index, 1);
                    this.showNotification(`${product.name} removed from comparison`);
                } else {
                    if (this.items.length >= this.maxItems) {
                        this.showNotification(`Maximum ${this.maxItems} items can be compared`);
                        return;
                    }
                    this.items.push(product);
                    this.showNotification(`${product.name} added to comparison`);
                }
                console.log('Compare:', this.items);
            }

            showNotification(message) {
                const notification = document.createElement('div');
                notification.textContent = message;
                notification.style.cssText = 'position: fixed; top: 80px; right: 20px; background: #D4AF37; color: #000; padding: 15px 25px; border-radius: 10px; font-weight: 600; z-index: 10001;';
                document.body.appendChild(notification);

                setTimeout(() => notification.remove(), 2000);
            }
        }

        // Newsletter Class
        class Newsletter {
            constructor() {
                this.subscribers = [];
            }

            subscribe(email) {
                if (!this.isValidEmail(email)) {
                    throw new Error('Please enter a valid email address');
                }

                if (this.subscribers.includes(email)) {
                    throw new Error('This email is already subscribed');
                }

                this.subscribers.push(email);
                return true;
            }

            isValidEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }
        }

        // DataFetcher Class - Handles JSON data fetching
        class DataFetcher {
            static async fetchProducts(url) {
                try {
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    return data;
                } catch (error) {
                    console.error('Error fetching products:', error);
                    throw error;
                }
            }
        }

        // ========== INITIALIZE APPLICATION ==========
        
        // Global instances
        const wishlistManager = new WishlistManager();
        const compareManager = new CompareManager();
        const newsletter = new Newsletter();

        // Collections
        let newArrivalsCollection;
        let mostGiftedCollection;
        let recentlyViewedCollection;
        let allProducts = [];

        // Fetch and render products
        async function initializeProducts() {
            try {
                // IMPORTANT: Replace 'products.json' with the actual path to your JSON file
                // If the JSON file is in the same directory as the HTML file, use: './products.json'
                // If it's in a different location, provide the correct path
                const data = await DataFetcher.fetchProducts('./products.json');
                
                // Create collections
                newArrivalsCollection = new ProductCollection('New Arrivals');
                mostGiftedCollection = new ProductCollection('Most Gifted');
                recentlyViewedCollection = new ProductCollection('Recently Viewed');

                // Add products to collections
                newArrivalsCollection.addProducts(data.collections.newArrivals);
                mostGiftedCollection.addProducts(data.collections.mostGifted);
                recentlyViewedCollection.addProducts(data.collections.recentlyViewed);

                // Store all products for search
                allProducts = [
                    ...newArrivalsCollection.products,
                    ...mostGiftedCollection.products,
                    ...recentlyViewedCollection.products
                ];

                // Render products
                newArrivalsCollection.render('newArrivalsGrid');
                mostGiftedCollection.render('mostGiftedGrid');
                recentlyViewedCollection.render('recentlyViewedGrid');

                console.log('Products loaded successfully!');
                console.log('Total products:', allProducts.length);

            } catch (error) {
                console.error('Failed to load products:', error);
                showError('Failed to load products. Please check if products.json file exists.');
            }
        }

        // Show error message
        function showError(message) {
            const grids = ['newArrivalsGrid', 'mostGiftedGrid', 'recentlyViewedGrid'];
            grids.forEach(gridId => {
                const container = document.getElementById(gridId);
                if (container) {
                    container.innerHTML = `<div class="error-message">${message}</div>`;
                }
            });
        }

        // Filter functionality
        function setupFilters() {
            const filterButtons = document.querySelectorAll('.filter-btn');
            
            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    // Update active button
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    const category = button.getAttribute('data-filter');
                    
                    // Filter all sections
                    filterProducts(category);
                });
            });
        }

        function filterProducts(category) {
            const allCards = document.querySelectorAll('.product-card');
            
            allCards.forEach(card => {
                const productCategory = card.getAttribute('data-category');
                
                if (category === 'all' || productCategory === category) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Search functionality
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.trim();
                
                if (query.length === 0) {
                    // Show all products
                    document.querySelectorAll('.product-card').forEach(card => {
                        card.style.display = 'block';
                    });
                    return;
                }

                if (query.length < 2) return;

                // Search through all products
                const results = allProducts.filter(product => 
                    product.name.toLowerCase().includes(query.toLowerCase()) ||
                    product.category.toLowerCase().includes(query.toLowerCase())
                );

                // Hide all products first
                document.querySelectorAll('.product-card').forEach(card => {
                    card.style.display = 'none';
                });

                // Show matching products
                results.forEach(product => {
                    const card = document.querySelector(`.product-card[data-id="${product.id}"]`);
                    if (card) {
                        card.style.display = 'block';
                    }
                });

                console.log(`Search results for "${query}":`, results.length, 'products found');
            });
        }

        // Newsletter form
        function setupNewsletter() {
            const newsletterForm = document.getElementById('newsletterForm');
            const newsletterMessage = document.getElementById('newsletterMessage');

            newsletterForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const emailInput = document.getElementById('newsletterEmail');
                
                try {
                    newsletter.subscribe(emailInput.value);
                    newsletterMessage.textContent = '✓ Successfully subscribed!';
                    newsletterMessage.style.color = '#D4AF37';
                    emailInput.value = '';
                } catch (error) {
                    newsletterMessage.textContent = '✗ ' + error.message;
                    newsletterMessage.style.color = '#ff6666';
                }

                setTimeout(() => {
                    newsletterMessage.textContent = '';
                }, 3000);
            });
        }

        // Add animation styles
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Initialize everything when DOM is ready
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('Initializing Aurelia Collections...');
            
            // Load products from JSON
            await initializeProducts();
            
            // Setup functionality
            setupFilters();
            setupSearch();
            setupNewsletter();
            
            console.log('Application ready!');
        });

        // Export for debugging (optional)
        window.AureliaApp = {
            wishlistManager,
            compareManager,
            newsletter,
            newArrivalsCollection,
            mostGiftedCollection,
            recentlyViewedCollection,
            allProducts
        };
    </script>
</body>
</html>