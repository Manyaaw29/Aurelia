{{! views/customerstories.hbs - RENDER with { layout: 'main', title: 'Community Stories', cssFile: 'customerstories.css' } }}

<canvas id="goldParticles"></canvas>

<main class="stories-page">
    <section class="hero-section">
        <div class="hero-content">
            <h1>Our Community's Legacy</h1>
            <div class="subtitle-container">
                <p>Real stories, real moments, beautifully captured with Aurelia's timeless jewelry.</p>
            </div>
        </div>
    </section>

    <section class="featured-story container">
        <div class="story-card large-card">
            <div class="story-image">
                <img src="featured-story-ring.jpg" alt="Engagement ring on hand">
            </div>
            <div class="story-details">
                <h2 class="story-title">A Promise Kept: The Aurora Ring</h2>
                <p class="story-author">— Sarah & Michael, New York</p>
                <p class="story-text">"When Michael proposed, he wanted something that symbolized both our future and our values. The Aurora ring, with its ethically-sourced lab-grown diamond, was perfect. It's a breathtaking piece that we're proud to start our life with. Thank you, Aurelia, for creating a truly responsible heirloom."</p>
                <a href="#full-story-1" class="read-more-btn">Read Full Story <i class="fas fa-arrow-right"></i></a>
            </div>
        </div>
    </section>

    <section class="story-grid container">
        <h2>More Moments</h2>
        
        <div class="story-card small-card">
            <div class="story-image">
                <img src="small-story-1.jpg" alt="Necklace on a bride">
            </div>
            <div class="story-details">
                <h3 class="story-title">The Wedding Day Pearl</h3>
                <p class="story-author">— Jessica L., London</p>
                <p class="story-text">"My Aurelia necklace was the final, perfect touch to my wedding attire. Classic elegance that I'll cherish forever."</p>
            </div>
        </div>
        
        <div class="story-card small-card">
            <div class="story-image">
                <img src="small-story-2.jpg" alt="Gold bracelet on a woman">
            </div>
            <div class="story-details">
                <h3 class="story-title">Everyday Elegance</h3>
                <p class="story-author">— David K., Sydney</p>
                <p class="story-text">"Bought the Solstice cuff for my wife's birthday. She hasn't taken it off. The quality is incredible."</p>
            </div>
        </div>
        
        <div class="story-card small-card">
            <div class="story-image">
                <img src="small-story-3.jpg" alt="Earrings in a box">
            </div>
            <div class="story-details">
                <h3 class="story-title">The First Heirloom</h3>
                <p class="story-author">— Maria S., Paris</p>
                <p class="story-text">"Purchased the Venus studs for my daughter's graduation. The perfect symbol of timeless achievement."</p>
            </div>
        </div>
        
        <div class="story-card submit-card">
            <h3>Share Your Aurelia Story</h3>
            <p>Your jewelry holds a moment. Tell us how Aurelia is part of your life's story.</p>
            <button class="cta-btn secondary-btn">Submit Your Story</button>
        </div>

    </section>
</main>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- Canvas Particle Background ---
        const canvas = document.getElementById('goldParticles');
        const ctx = canvas.getContext('2d');
        let w = canvas.width = window.innerWidth;
        let h = canvas.height = document.body.offsetHeight;
        let particles = [];

        window.addEventListener('resize', () => {
            w = canvas.width = window.innerWidth;
            h = canvas.height = document.body.offsetHeight;
        });

        class Particle {
            constructor() {
                this.x = Math.random() * w;
                this.y = Math.random() * h;
                this.size = Math.random() * 2 + 0.5;
                this.speedX = Math.random() * 0.5 - 0.25;
                this.speedY = Math.random() * 0.5 + 0.1;
                this.alpha = Math.random() * 0.5 + 0.1; // Fainter particles
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                if (this.y > h) {
                    this.y = 0 - this.size;
                    this.x = Math.random() * w;
                }
            }
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(212,175,55,${this.alpha})`;
                ctx.fill();
            }
        }

        for (let i = 0; i < 100; i++) particles.push(new Particle());

        function animate() {
            // Only clear if the canvas is in the visible viewport
            const rect = canvas.getBoundingClientRect();
            if (rect.top < window.innerHeight && rect.bottom > 0) {
                ctx.clearRect(0, 0, w, h);
                particles.forEach(p => {
                    p.update();
                    p.draw();
                });
            }
            requestAnimationFrame(animate);
        }
        animate();


        // --- Word-by-Word Reveal for Subtitle ---
        const subtitle = document.querySelector('.subtitle-container p');
        if (subtitle) {
            const words = subtitle.textContent.trim().split(/\\s+/);
            subtitle.innerHTML = words.map(w => `<span class="word">${w}</span>`).join(" ");

            // Inject keyframe style for the animation
            const style = document.createElement('style');
            style.textContent = `
                .subtitle-container .word {
                    display: inline-block;
                    opacity: 0;
                    transform: translateY(10px);
                    transition: opacity 0.3s ease-out, transform 0.3s ease-out;
                }
                .subtitle-container .word.visible {
                    opacity: 1;
                    transform: translateY(0);
                }
            `;
            document.head.appendChild(style);

            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const wordEls = subtitle.querySelectorAll('.word');
                        wordEls.forEach((w, i) => {
                            setTimeout(() => w.classList.add('visible'), i * 80);
                        });
                        observer.unobserve(subtitle);
                    }
                });
            }, { threshold: 0.2 });
            
            observer.observe(subtitle);
        }
    });
</script>